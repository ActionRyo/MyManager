define("fishstrap/ui/input.js",function(e,i,t){{var a=e("fishstrap/core/global.js"),d=e("fishstrap/ui/dialog.js"),n=e("fishstrap/ui/editor.js"),r=e("fishstrap/ui/table.js"),l=e("fishstrap/util/upload.js");e("fishstrap/page/subPage.js")}e("fishstrap/util/jqueryDatetimePicker.js"),t.exports={flowInput:function(e){var i={id:"",field:[],value:{},submit:function(){}};for(var t in e)i[t]=e[t];if(0!=i.field.length){for(var d="",t=0;t!=i.field.length;++t){var n=i.field[t];if("text"==n.type)d+="<span>&nbsp;"+n.name+'：</span><input type="text" name="'+n.id+'" class="input-small"/>';else if("time"==n.type)d+="<span>&nbsp;"+n.name+'：</span><input type="text" name="'+n.id+'" class="time input-small"/>';else if("enum"==n.type){var e="";"undefined"!=typeof n.map[""]&&(e+='<option value="">'+n.map[""]+"</option>");for(var r in n.map)""!=r&&(e+='<option value="'+r+'">'+n.map[r]+"</option>");d+="<span>&nbsp;"+n.name+'：</span><select name="'+n.id+'">'+e+"</select>"}}d+='<button type="button" class="btn query">查询</button><button type="reset" class="btn">重置</button>',d=a(d),a("#"+i.id).append(d);for(var t=0;t!=i.field.length;++t){var n=i.field[t];"time"==n.type&&a("#"+i.id).find("input[name="+n.id+"]").datetimepicker({lang:"ch",timepicker:!1,format:"Y-m-d",closeOnDateSelect:!0})}for(var t=0;t!=i.field.length;++t){var n=i.field[t],l=i.value[n.id];l&&("text"==n.type?a("#"+i.id).find("input[name="+n.id+"]").val(l):"time"==n.type?a("#"+i.id).find("input[name="+n.id+"]").val(l):"enum"==n.type&&a("#"+i.id).find("select[name="+n.id+"]").val(l))}a("#"+i.id).find(".query").click(function(){for(var e={},t=0;t!=i.field.length;++t){var d=i.field[t];"text"==d.type?e[d.id]=a.trim(a("#"+i.id).find("input[name="+d.id+"]").val()):"time"==d.type?e[d.id]=a.trim(a("#"+i.id).find("input[name="+d.id+"]").val()):"enum"==d.type&&(e[d.id]=a.trim(a("#"+i.id).find("select[name="+d.id+"]").val()))}i.submit(e)})}},verticalInput:function(e){function i(e){for(var i=0;i!=s.field.length;++i){var t=s.field[i];if("undefined"!=typeof e[t.id])if("read"==t.type)p.find("div[name="+t.id+"]").text(e[t.id]);else if("link"==t.type)p.find("div[name="+t.id+"]").text(e[t.id]),p.find("a[name="+t.id+"]").attr("href",e[t.id]);else if("fullEditor"==t.type)t._editor.setContent(e[t.id]);else if("simpleEditor"==t.type)t._editor.setFormatData(e[t.id]);else if("image"==t.type)p.find("img[name="+t.id+"]").attr("src",e[t.id]);else if("file"==t.type)p.find("div[name="+t.id+"]").text(e[t.id]);else if("compressFile"==t.type){var d=_.map(e[t.id],function(e){return{name:'<a href="'+e+'" target="_blank">'+e+"</a>"}});t.tableOperation.clear(),t.tableOperation.add(d)}else"area"==t.type?p.find("textarea[name="+t.id+"]").val(e[t.id]):"text"==t.type||"password"==t.type||"time"==t.type?p.find("input[name="+t.id+"]").val(e[t.id]):"enum"==t.type?p.find("select[name="+t.id+"]").val(e[t.id]):"check"==t.type?p.find("input[name="+t.id+"]").each(function(){for(var i=0;i!=e[t.id].length;++i){var d=e[t.id][i];if(a(this).val()==d)return void a(this).attr("checked",!0)}a(this).attr("checked",!1)}):"table"==t.type&&t.tableOperation.add(e[t.id])}}function t(){for(var e={},i=0;i!=s.field.length;++i){var t=s.field[i];"read"==t.type?e[t.id]=a.trim(a("#"+s.id).find("div[name="+t.id+"]").text()):"link"==t.type?e[t.id]=p.find("a[name="+t.id+"]").attr("href"):"simpleEditor"==t.type?e[t.id]=t._editor.getFormatData():"fullEditor"==t.type?e[t.id]=t._editor.getContent():"image"==t.type?e[t.id]=a.trim(a("#"+s.id).find("img[name="+t.id+"]").attr("src")):"file"==t.type?e[t.id]=a.trim(a("#"+s.id).find("div[name="+t.id+"]").text()):"compressFile"==t.type?e[t.id]=_.map(t.tableOperation.get(),function(e){return e.name}):"area"==t.type?e[t.id]=a.trim(a("#"+s.id).find("textarea[name="+t.id+"]").val()):"text"==t.type||"password"==t.type||"time"==t.type?e[t.id]=a.trim(a("#"+s.id).find("input[name="+t.id+"]").val()):"enum"==t.type?e[t.id]=a.trim(a("#"+s.id).find("select[name="+t.id+"]").val()):"check"==t.type?(e[t.id]=[],a("#"+s.id).find("input[name="+t.id+"]:checked").each(function(){e[t.id].push(a(this).val())})):"table"==t.type&&(e[t.id]=t.tableOperation.get())}return e}var s={id:"",field:[],value:{},submit:function(){},cancel:function(){}};for(var o in e)s[o]=e[o];var p="",f="";a.console.log(a.JSON.stringify(s.field));for(var o=0;o!=s.field.length;++o){var u=s.field[o];if(f+='<tr><td class="tableleft" style="width:20%;">'+u.name+"</td>",f+="undefined"!=typeof u.targetId?'<td id="'+u.targetId+'">':"<td>","read"==u.type)f+='<div name="'+u.id+'"/>';else if("time"==u.type)f+='<input type="text" name="'+u.id+'" class="time input-small"/>';else if("link"==u.type)f+='<a name="'+u.id+'" target="_blank"><div name="'+u.id+'"/></a>';else if("fullEditor"==u.type)u.editorTargetId=a.uniqueNum(),f+='<div class="alert alert-danger" role="alert">注意！为了保证微信内观看视频的兼容性，强烈建议你只插入腾讯视频网址，不要插入其它视频网站，或直接上传视频。</div><div name="'+u.id+'" id="'+u.editorTargetId+'"/>';else if("simpleEditor"==u.type)u.editorTargetId=a.uniqueNum(),f+='<div name="'+u.id+'" id="'+u.editorTargetId+'"/>';else if("image"==u.type)u.imageTargetId=a.uniqueNum(),u.imageProgressTargetId=a.uniqueNum(),f+='<div><img name="'+u.id+'" src=""/></div><div class="progress"><div class="bar" id="'+u.imageProgressTargetId+'"></div></div><div class="btn" id="'+u.imageTargetId+'"><span>点击这里上传图片</span></div>';else if("file"==u.type)u.fileTargetId=a.uniqueNum(),u.fileProgressTargetId=a.uniqueNum(),f+='<div name="'+u.id+'"></div><div class="progress"><div class="bar" id="'+u.fileProgressTargetId+'"></div></div><div class="btn" id="'+u.fileTargetId+'"><span>点击这里上传文件</span></div>';else if("compressFile"==u.type)u.tableId=a.uniqueNum(),u.fileTargetId=a.uniqueNum(),u.fileProgressTargetId=a.uniqueNum(),f+='<div id="'+u.tableId+'"></div><div class="progress"><div class="bar" id="'+u.fileProgressTargetId+'"></div></div><div class="btn" id="'+u.fileTargetId+'"><span>点击这里上传压缩文件</span></div>';else if("area"==u.type){var m="";0==_.isUndefined(u.disabled)&&u.disabled===!0&&(m='disabled="true"'),f+='<textarea name="'+u.id+'" style="width:90%;height:300px;" '+m+"></textarea>"}else if("text"==u.type)f+='<input type="text" name="'+u.id+'"/>';else if("password"==u.type)f+='<input type="password" name="'+u.id+'"/>';else if("enum"==u.type){var m="";0==_.isUndefined(u.disabled)&&u.disabled===!0&&(m='disabled="true"');var e="";for(var c in u.map)e+='<option value="'+c+'">'+u.map[c]+"</option>";f+="<select "+m+' name="'+u.id+'">'+e+"</select>"}else if("check"==u.type){var m="";0==_.isUndefined(u.disabled)&&u.disabled===!0&&(m='disabled="true"');var e="";for(var c in u.map)e+='<span><input type="checkbox" '+m+' name="'+u.id+'" value="'+c+'">'+u.map[c]+"</span>&nbsp;&nbsp;";f+=e}else if("table"==u.type){u.tableId=a.uniqueNum(),f+="<div>";for(var c=0;c!=u.option.button.length;++c){var v=u.option.button[c];v.buttonId=a.uniqueNum(),f+='<button type="button" class="btn" id="'+v.buttonId+'">'+v.name+"</button>",u.option.button[c]=v}f+="</div>",f+='<div id="'+u.tableId+'"></div>'}f+="</td></tr>"}var g="";(0==_.isUndefined(s.submit)||0==_.isUndefined(s.cancel))&&(g+='<tr><td class="tableleft"></td><td>',0==_.isUndefined(s.submit)&&(g+='<button type="button" class="btn btn-primary submit" >提交</button>'),0==_.isUndefined(s.cancel)&&(g+='<button type="button" class="btn btn-success cancel">返回列表</button>'),g+="</td></tr>"),p+='<table class="table table-bordered table-hover definewidth m10">'+f+g+"</table>",p=a(p),a("#"+s.id).append(p);for(var o=0;o!=s.field.length;++o){var u=s.field[o];!function(e){if("image"==e.type)l.image({url:e.option.url,urlToken:e.option.urlToken,urlType:e.option.urlType,target:e.imageTargetId,field:"data",width:e.option.width,height:e.option.height,quality:.8,onProgress:function(i){a.console.log(i),a("#"+e.imageProgressTargetId).text(i+"%"),a("#"+e.imageProgressTargetId).css("width",i+"%")},onSuccess:function(i){return i=a.JSON.parse(i),0!=i.code?void d.message(i.msg):void p.find("img[name="+e.id+"]").attr("src",i.data)},onFail:function(e){d.message(e)}});else if("file"==e.type)l.file({url:e.option.url,target:e.fileTargetId,field:"data",type:e.option.type,maxSize:e.option.maxSize,onProgress:function(i){a("#"+e.fileProgressTargetId).text(i+"%"),a("#"+e.fileProgressTargetId).css("width",i+"%")},onSuccess:function(i){return i=a.JSON.parse(i),0!=i.code?void d.message(i.msg):void p.find("div[name="+e.id+"]").text(i.data)},onFail:function(e){d.message(e)}});else if("compressFile"==e.type)e.tableOperation=r.staticSimpleTable({id:e.tableId,data:[],column:[{id:"name",type:"html",name:"文件"}],operate:[]}),l.file({url:e.option.url,target:e.fileTargetId,field:"data",type:e.option.type,maxSize:e.option.maxSize,onProgress:function(i){a.console.log(i),a("#"+e.fileProgressTargetId).text(i+"%"),a("#"+e.fileProgressTargetId).css("width",i+"%")},onSuccess:function(i){if(i=a.JSON.parse(i),0!=i.code)return void d.message(i.msg);var t=_.map(i.data,function(e){return{name:'<a href="'+e+'" target="_blank">'+e+"</a>"}});e.tableOperation.clear(),e.tableOperation.add(t)},onFail:function(e){d.message(e)}});else if("simpleEditor"==e.type)e._editor=n.simpleEditor({id:e.editorTargetId,url:e.option.url});else if("fullEditor"==e.type)e._editor=n.fullEditor({id:e.editorTargetId,url:e.option.url});else if("time"==e.type)a("#"+s.id).find("input[name="+e.id+"]").datetimepicker({lang:"ch",timepicker:!1,format:"Y-m-d",closeOnDateSelect:!0});else if("table"==e.type){e.tableOperation=r.staticSimpleTable({id:e.tableId,data:[],column:e.option.column,operate:e.option.operate});for(var i=0;i!=e.option.button.length;++i){var t=e.option.button[i];a("#"+t.buttonId).click(function(){t.click(e.tableOperation)})}}}(u)}return i(s.value),p.find(".submit").click(function(){s.submit(t())}),p.find(".cancel").click(s.cancel),{get:t,set:i}}}});